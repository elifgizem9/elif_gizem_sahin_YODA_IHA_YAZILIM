## NESNE TESPİT MODELLERİ

# Nesne Tespiti Konusunda Devrimsel Gelişmeler

Nesne tespiti tarihinde en büyük kırılma noktası, geleneksel yöntemlerden derin öğrenme yöntemlerine geçiştir. Bu devrimin mihenk taşları şunlardır:

**2012 AlexNet ve ImageNet Yarışması:** AlexNet'in başarısı, Evrişimli Sinir Ağlarının (CNN) görsel verilerde insanüstü performans gösterebileceğini kanıtladı.
**GPU Teknolojisinin Gelişimi:** NVIDIA gibi firmaların geliştirdiği yüksek işlem kapasiteli GPU'lar, çok katmanlı ağların eğitilmesini mümkün kıldı.
**Büyük Veri Setleri:** COCO ve ImageNet gibi etiketli devasa veri setlerinin oluşturulması, modellerin genelleme yeteneğini artırdı.

# CNN 

**Önceki Modeller:**
Eski yöntemlerde, öznitelik çıkarımı elle yapılırdı. Mühendisler kenar, köşe veya doku gibi özellikleri matematiksel formüllerle tanımlamak zorundaydı. Bu yöntemler ışık değişimlerine ve farklı açılara karşı dayanıksızdı.

**CNN (Convolutional Neural Networks) Mantığı:**
CNN tabanlı modellerde öznitelik çıkarımı otomatiktir. Model, eğitim sırasında hangi özelliklerin önemli olduğunu kendi kendine öğrenir.

**Convolution:** Görüntü üzerinde filtreler gezdirilerek temel özellikler yakalanır.
**Pooling:** Görüntü boyutu küçültülerek işlem yükü azaltılır ve önemli özellikler korunur.
**Hiyerarşik Öğrenme:** İlk katmanlar basit çizgileri öğrenirken, derin katmanlar göz, tekerlek, yüz gibi karmaşık nesneleri öğrenir.

# Nesne Tespitinde Kullanılan Modeller

Nesne tespiti modelleri iki ana kategoriye ayrılır:

**Two-Stage Modeller:** Önce nesne olabilecek bölgeleri önerir, sonra sınıflandırır. Çok hassas ve yavaştırlar.
Örn: R-CNN, Fast R-CNN, Faster R-CNN.
**One-Stage Modeller:** Görüntüye tek bir sefer bakar ve aynı anda hem nesnenin yerini hem de sınıfını tahmin eder. Gerçek zamanlı uygulamalar için idealdir.
Örn:YOLO (You Only Look Once), SSD (Single Shot MultiBox Detector), RetinaNet.

## YOLO 

# YOLO Nedir ve Nasıl Çalışır?

**YOLO:** Hız ve performansı optimize eden, one-stage bir nesne tespit algoritmasıdır.

Görüntüyü AxA boyutunda grid'lere böler. Her bir grid, kendi içinde bir nesne merkezi olup olmadığını tahmin eder. Tek bir ileri beslemeli sinir ağı örn. CNN ile tüm görüntüdeki
bounding boxes'ları ve sınıf olasılıklarını aynı anda hesaplar.

# Loss Functions ve mAP

YOLO eğitimi sırasında modelin ne kadar hata yaptığını ölçen metriklerdir:
**Box_loss:** Tahmin edilen kutunun koordinatlarının, gerçek kutudan ne kadar saptığını ölçer Genellikle IoU kullanılır.
**Cls_loss:** Nesnenin doğru sınıfa atanıp atanmadığını ölçer.
**Val_loss:** Modelin eğitim sırasında hiç görmediği veri üzerindeki hatasıdır.
**mAP (Mean Average Precision):** Modelin genel başarısını gösteren en önemli metriktir. Farklı IoU eşiklerinde modelin hassasiyetinin yani precision ortalamasını ifade eder. mAP ne kadar yüksekse model o kadar başarılıdır.

# YOLO Özelinde Temel Hiperparametreler

Modeli eğitmeden önce ayarlanan yapılandırma değerleridir:

**Epoch:** Tüm veri setinin eğitimden kaç kez geçirileceği.
**Batch Size:** Modelin ağırlıklarını güncellemeden önce aynı anda işleyeceği görüntü sayısı.
**Learning Rate:** Modelin hatalarından ne kadar hızlı ders çıkaracağıdır. Çok büyükse öğrenemez, çok küçükse çok yavaş öğrenir.
**Imgz (Image Size):** Giriş görüntüsünün çözünürlüğüdür.



#   Segmentasyon vs. Detection:
**Detection:** Nesneyi bir dikdörtgen kutu içine alır.
**Segmentation:** Nesnenin tam sınırlarını piksel piksel belirler (maskeleme yapar).
# Boyut Farkları, Nano, Small, Medium, Large, X-Large - n, s, m, l, x:
Bu harfler modelin katman sayısını ve kanal sayısını ifade eder.
**Small (s):** Daha az parametre, çok hızlı çalışır, doğruluk oranı daha düşüktür.
**Large/X-Large (l, x):** Çok fazla parametre, yavaş çalışır ancak doğruluk oranı çok yüksektir. Güçlü GPU gerektirir.

# İdeal Dataset Özellikleri 
Nesneler farklı açılardan, farklı ışık koşullarında ve farklı arka planlarda çekilmelidir.
Her sınıftan örn. araba, yaya yaklaşık eşit sayıda örnek olmalıdır.
Etiketlemeler yani kutular nesneyi tam sarmalı, ne çok geniş ne çok dar olmalıdır.
Derin öğrenme çok veriye ihtiyaç duyar. Sınıf başına en az 100-200 görsel önerilir YOLO için.

# Augmentation

Var olan görüntüleri yapay yollarla değiştirerek veri setini zenginleştirme işlemidir. Ezberlemeyi engeller. Gerçek hayatta karşılaşılabilecek senaryoları simüle etmelidir.

**Mosaic Augmentation:** YOLO'ya özgüdür, 4 farklı fotoğrafı birleştirip tek kare yaparak modelin küçük nesneleri ve karmaşık sahneleri öğrenmesini sağlar.

# Roboflow ve Veri Etiketleme
**Roboflow:** Bilgisayarlı görü projeleri için veri seti yönetimi, etiketleme ve preprocessing platformudur.
Fotoğraflar yüklenir, tarayıcı üzerinden nesneler kare içine alınarak etiketlenir. Ardından augmentation işlemleri seçilir ve veri seti YOLO formatında (TXT) indirilir.

# Diğer Veri Etiketleme Platformları

**LabelImg:** Açık kaynaklı, masaüstü uygulamasıdır. İnternet gerektirmez ancak otomasyon özellikleri azdır.
**CVAT (Computer Vision Annotation Tool):** Intel tarafından geliştirilmiştir. Çok detaylıdır ve video etiketlemeyi destekler, kurulumu ve arayüzü karmaşıktır.
**LabelMe:** Poligon etiketleme için sıkça kullanılır.

# Google Colab Ortamında YOLO Training ve Detection

1. "pip install ultralytics" komutu ile YOLO kütüphanesi kurulur.
2. Roboflow'dan veya Drive'dan veri seti çekilir.
3. " python
   !yolo task=detect mode=train model=yolov8s.pt data=data.yaml epochs=100 imgsz=640" komutu ile eğitim başlatılır. "data.yaml" dosyasında sınıfların ve görüntülerin yolları bulunur.
4. Eğitilen model "best.pt" kullanılarak yeni görüntüler üzerinde tahmin yapılır:
   "python
    !yolo task=detect mode=predict model=runs/detect/train/weights/best.pt source='test_image.jpg' "
  